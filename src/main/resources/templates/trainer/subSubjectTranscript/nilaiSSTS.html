<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout.html}">
    <head>
        <title>peserta</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <section layout:fragment="judulHero">
            <h4> Daftar SubSubject </h4>
        </section>
        <section layout:fragment="content">
            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4" style="margin-right:  8rem">
                <button type="button" class="btn btn-primary ms-2" data-bs-toggle="modal" data-bs-target="#modalPilihSubject"> edit nilai</button>
            </div>
            

            <!-- Modal -->
            <div class="modal fade" id="modalPilihSubject" tabindex="-1" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Pilih sub Subject</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <a href="#" id="hidden_trigger_a" style="visibility: hidden" >Check</a>
                        <div class="modal-body">
                            <form id="modalForm">
                                <label for="id_subsubject" class="form-label">Sub Subject : </label>
                                <select id="id_subsubject" class="form-select">

                                </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" id="submitModalTrainer">Pilih</button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>

            <!--tabel-->
            <div class="container table__container" style="background-color: white; margin-top: 1rem;">
                <div class="row table__wrapper">
                    <table class="table table-striped" id="tabel_ssts">
                        <thead>
                            <tr>
                                <th>Nama</th>

                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>

        </section>

        <script layout:fragment="scripts">
            $(document).ready(function () {
                getAllSubSubjectBySubjectId();
            });

            //Inisialisasi data table dengan ajax
            var class_id = window.location.href.split('/')[5];
            var sts_id = window.location.href.split('/')[6];
            if (sts_id == 1) {
                let row = "";
                row = `<th>Select Statement</th>
                        <th>sortingData</th>
                        <th>singleRowFunction</th>
                        <th>groupFunction</th>
                        <th>subquery</th>
                        <th>grade name</th>`;
                $('#tabel_ssts thead tr').append(row);

                var tb = $('#tabel_ssts').DataTable({
                    ajax: {
                        url: '/subsubject_transcript/' + class_id + "/" + sts_id,
                        dataSrc: 'data'
                    },
                    columns: [
                        {data: 'fullname'},
                        {data: 'selectStatement'},
                        {data: 'sortingData'},
                        {data: 'singleRowFunction'},
                        {data: 'groupFunction'},
                        {data: 'subquery'},
                        {data: 'gradeName'}

                    ],
                    "filter": false,
                    "ordering": false,
                    "lengthChange": false,
                    "language": {
                        "info": "_START_ - _END_ of _TOTAL_ items",
                        "infoEmpty": "0 to 0 of 0 items",
                        "infoFiltered": "(filtered from _MAX_ items)",
                    }
                });
            }
            if (sts_id == 2) {
                let row = "";
                row = `<th>restTemplate</th>
                        <th>ajax</th>
                        <th>thymleaf</th>
                        <th>security</th>
                        <th>grade name</th>`;
                $('#tabel_ssts thead tr').append(row);
                var tb = $('#tabel_ssts').DataTable({
                    ajax: {
                        url: '/subsubject_transcript/' + class_id + "/" + sts_id,
                        dataSrc: 'data'
                    },
                    columns: [
                        {data: 'fullname'},
                        {data: 'restTemplate'},
                        {data: 'ajax'},
                        {data: 'thymleaf'},
                        {data: 'security'},
                        {data: 'gradeName'}

                    ],
                    "filter": false,
                    "ordering": false,
                    "lengthChange": false,
                    "language": {
                        "info": "_START_ - _END_ of _TOTAL_ items",
                        "infoEmpty": "0 to 0 of 0 items",
                        "infoFiltered": "(filtered from _MAX_ items)",
                    }
                });
            }
            if (sts_id == 3) {
                let row = "";
                row = `<th>jpa</th>
                        <th>mvc</th>
                        <th>dto</th>
                        <th>grade name</th>`;
                $('#tabel_ssts thead tr').append(row);
                var tb = $('#tabel_ssts').DataTable({
                    ajax: {
                        url: '/subsubject_transcript/' + class_id + "/" + sts_id,
                        dataSrc: 'data'
                    },
                    columns: [
                        {data: 'fullname'},
                        {data: 'jpa'},
                        {data: 'mvc'},
                        {data: 'dto'},
                        {data: 'gradeName'}

                    ],
                    "filter": false,
                    "ordering": false,
                    "lengthChange": false,
                    "language": {
                        "info": "_START_ - _END_ of _TOTAL_ items",
                        "infoEmpty": "0 to 0 of 0 items",
                        "infoFiltered": "(filtered from _MAX_ items)",
                    }
                });
            }
            if (sts_id == 4) {
                let row = "";
                row = `<th>tugasAkhir</th>
                        <th>grade name</th>`;
                $('#tabel_ssts thead tr').append(row);
                var tb = $('#tabel_ssts').DataTable({
                    ajax: {
                        url: '/subsubject_transcript/' + class_id + "/" + sts_id,
                        dataSrc: 'data'
                    },
                    columns: [
                        {data: 'fullname'},
                        {data: 'tugasAkhir'},
                        {data: 'gradeName'}

                    ],
                    "filter": false,
                    "ordering": false,
                    "lengthChange": false,
                    "language": {
                        "info": "_START_ - _END_ of _TOTAL_ items",
                        "infoEmpty": "0 to 0 of 0 items",
                        "infoFiltered": "(filtered from _MAX_ items)",
                    }
                });
            }





            //bisa
            $('#submitModalTrainer').click((e) => {
                e.preventDefault();
                var class_id = window.location.href.split('/')[5];
                var id_subject = $('#id_subsubject').val();
                console.log(id_subject);
                $('#hidden_trigger_a').attr('href', '/subsubject_transcript/trainer/edit/' + class_id + "/" + id_subject);
                $('#hidden_trigger_a')[0].click();
            });

            function getAllSubSubjectBySubjectId() {
                $.ajax({
                    type: "GET",
                    url: "/subsubject/subject_Trainer/" + window.location.href.split('/')[6],
                    data: "data",
                    dataType: "json",
                    success: function (response) {
                        let row = "";
                        response.data.forEach(data => {
                            row += `
                        <option value=${data.subSubjectId}>${data.subSubjectName}</option>
                        `
                        });
                        $('#id_subsubject').append(row);
                    }
                });
            }
        </script>
    </body>
</html>
