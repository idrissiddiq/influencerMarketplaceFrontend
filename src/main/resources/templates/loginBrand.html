
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html prefix="og: http://ogp.me/ns#" lang="en" style="height: 100%">

<head>
    <meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=5" />

    <title>login</title>
    <meta name="description" content="login Description">
    <meta property="og:title" content="login">
    <meta property="og:description" content="login Description">
    <meta name="generator" content="Quest">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:600">
    <link th:href="@{/css/index.css}" rel="stylesheet"></link>
    <meta th:name="_csrf" th:content="${_csrf.token}" />
    <meta th:name="_csrf_header" th:content="${_csrf.headerName}" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-uWxY/CJNBR+1zjPWmfnSnVxwRheevXITnMqoEIeG1LJrdI0GlVs/9cVSyPYXdcSF"
          crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kQtW33rZJAHjgefvhyyzcGF3C5TFyBQBA13V1RKPf4uH+bwyzQxZ6CmMZHmNBEfJ"
            crossorigin="anonymous">
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.8/dist/sweetalert2.all.min.js"
            integrity="sha256-voaY/mFuF2+Kg/L56O9wmuwvhHf3XcaxCI/Ld9UR+d4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.8/dist/sweetalert2.min.js"
            integrity="sha256-UEAn96ePJjqidezAU7lnOYeJEArgg4hsNGbwqmcyPrY=" crossorigin="anonymous"></script>



</head>
<body class="websiteBody" style="background-color: #F7F8FC;">
<div class="login">
    <div class="Grading-application-outer" style="margin-top : 40px;">
        <div class="Grading-application">
            <div class="Title-outer">
                <div class="Title">
                    <div class="Grading-Application-outer">
                        <div class="Grading-Application">
                            <div>Grading Application</div>
                        </div>
                    </div>
                </div>
            </div>
            <form th:action="@{/login/brand}" th:method="POST" th:object="${loginRequest}">
                <div class="Input-1">
                    <label class="Email" for="username" >Username</label>
                    <input type="text" class="form-control Isian" id="username" th:field="*{username}">
                    <label class="Email" for="password" >Password</label>
                    <input type="password" class="form-control Isian" id="password" th:field="*{password}">
                </div>
                <div class="Input-2-outer">
                    <div class="Input-2">
                        <div class="Password-outer">
                            <div
                                    id="Password"
                                    data-name="Password"
                                    class="Password"
                            >
                                <!-- <div key="0">Password</div> -->
                            </div>
                        </div>
                        <div class="Rectangle-226-1-outer">
                            <!-- <div
                              id="Rectangle-226-1"
                              data-name="Rectangle 226"
                              alt="Rectangle 226"
                              class="Rectangle-226-1"
                            >
                            </div> -->
                        </div>
                        <!--              <a th:href="@{/forgot_password}" class="Forgot-Password-">Forgot Password?</a>-->
                    </div>
                </div>
                <div class="Button">


                    <button class="w-100 btn btn-lg btn-primary" type="submit" key="0">Sign In</button>


                </div>
            </form>
        </div>
        <div class="Button">
            <!--                <a href="#" class="link">Forgot your password?</a>-->
            <button type="button" class="w-100 btn btn-lg btn-primary" data-bs-toggle="modal"
                    data-bs-target="#forgotPassword">Forgot your password?</button>
        </div>
        <div class="Button">
            <!--                <a href="#" class="link">Forgot your password?</a>-->
            <button type="button" class="w-100 btn btn-lg btn-primary" data-bs-toggle="modal"
                    data-bs-target="#registBrand">Don't have account? Register Now!</button>
        </div>
    </div>
    <div class="Left-outer">
        <div class="Left">
            <!--insert image here-->
        </div>
    </div>
    <div class="Background-1-outer">
        <div class="Background-1"></div>
    </div>
</div>
<!-- Modal Forgot Password -->
<div id="forgotPassword" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="regionCreatedLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="regionCreatedLabel">Your New Password Will Be Send Via Email</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="error-message">
                </div>
                <div class="col">
                    <label class="form-label ">Your Email:</label>
                    <input class="form-control" type="email" name="email" id="email" placeholder="Your Email"
                           required="">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="forgotPassword()">Get New Password</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal Register Influencer -->
<div id="registBrand" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="regionCreatedLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="registTable">Fill All the Form Below</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="error-message">
                </div>
                <div class="col">
                    <label class="form-label ">Your Full Name:</label>
                    <input class="form-control" type="text" name="name" id="name" placeholder="Your Full Name"
                           required="">
                </div>
                <div class="col">
                    <label class="form-label ">Your Email:</label>
                    <input class="form-control" type="email" name="emailRegist" id="emailRegist" placeholder="Your Email"
                           required="">
                </div>
                <div class="col">
                    <label class="form-label ">Your Username:</label>
                    <input class="form-control" type="text" name="usernameRegist" id="usernameRegist" placeholder="Your Username"
                           required="">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="registBrand()">Create My Account</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" th:src="@{/js/login.js}"></script>
<th:block layout:fragment="script">
    <script th:inline="javascript">
        function forgotPasswordProcess() {
                let email = $('#email').val();
                if (email != '') {
                    $.ajax({
                        method: "PUT",
                        url: '/register/brand/forgot',
                        dataType: "json",
                        data: JSON.stringify({
                            email: email
                        }),
                        contentType: "application/json",
                        success: function (result) {
                            console.log("SUCCESS : ", result);
                            $('#forgotPassword').modal('hide');
                            window.location = window.location;
                         //   getCampaign.ajax.reload();
                         //   location.reload();
                        }
                    //    fail: function(xhr, textStatus, errorThrown){
                     //       location.reload();
                     //   }
                    });
                } else {
                    console.log("Error");
                    $('#forgotPassword').modal('hide');
                }
            };

            function registBrandProcess() {
                let email = $('#emailRegist').val();
                let fullname = $('#name').val();
                let username = $('#usernameRegist').val();
                if (email != '') {
                    $.ajax({
                        method: "POST",
                        url: '/register/brand',
                        dataType: "json",
                        data: JSON.stringify({
                            fullname: fullname,
                            email: email,
                            username: username
                        }),
                        contentType: "application/json",
                        success: function (result) {
                            console.log("SUCCESS : ", result);
                            $('#registBrand').modal('hide');
                            window.location = window.location;
                         //   getCampaign.ajax.reload();
                         //   location.reload();
                        }
                    //    fail: function(xhr, textStatus, errorThrown){
                     //       location.reload();
                     //   }
                    });
                } else {
                    console.log("Error");
                    $('#registBrand').modal('hide');
                }
            };

            function forgotPassword() {
                Swal.fire({
                    title: 'Are you sure?',
                    text: "Your Password Will Change and It Will Send Via Email!",
                    icon: 'info',
                    showDenyButton: true,
                    confirmButtonColor: '#3085d6',
                    denyButtonColor: '#d33',
                    confirmButtonText: 'Yes, change my password!',
                    denyButtonText: 'Cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // document.getElementById(id).submit();
                        $('#forgotPassword').modal('hide');
                        $('body').removeClass('modal-open');
                        $('.modal-backdrop').remove();
                        Swal.fire(
                            'Updated!',
                            'Your password has been updated, please check your Email.',
                            'success'
                        )
                        forgotPasswordProcess();

                    } else if (result.isDenied) {
                        Swal.fire(
                            'Canceled!',
                            'Your password has not been updated.',
                            'error'
                        )
                    }
                })
            };

            function registBrand() {
                Swal.fire({
                    title: 'We Will Create an Account For You!',
                    text: "Your Password Will Send Via Email!",
                    icon: 'info',
                    showDenyButton: true,
                    confirmButtonColor: '#3085d6',
                    denyButtonColor: '#d33',
                    confirmButtonText: 'Yes, Make My Account!',
                    denyButtonText: 'Cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // document.getElementById(id).submit();
                        $('#registBrand').modal('hide');
                        $('body').removeClass('modal-open');
                        $('.modal-backdrop').remove();
                        Swal.fire(
                            'Created!',
                            'Your account has been created, please check your Email.',
                            'success'
                        )
                        registBrandProcess();

                    } else if (result.isDenied) {
                        Swal.fire(
                            'Canceled!',
                            'Your account has not been created.',
                            'error'
                        )
                    }
                })
            };
    </script>
</th:block>
</body>
</html>
  